mutation CreateCadModel(
  $ownerId: UUID!
  $projectId: UUID!
  $description: String!
  $isPublic: Boolean!
  $modelData: String!
  $name: String!
  $thumbnailUrl: String!
) @auth(level: USER) {
  # Updated to camelCase 'cadModel_insert'
  cadModel_insert(
    data: {
      ownerId: $ownerId
      projectId: $projectId
      description: $description
      isPublic: $isPublic
      modelData: $modelData
      name: $name
      thumbnailUrl: $thumbnailUrl
      # createdAt / updatedAt are now handled automatically
    }
  )
}

query ListPublicCadModels @auth(level: PUBLIC) {
  cadModels(where: {isPublic: {eq: true}}) {
    id
    name
    description
    thumbnailUrl
  }
}

mutation CreateFeedback(
  $cadModelId: UUID!
  $promptId: UUID!
  $userId: UUID!
  $comments: String!
  $rating: Int!
  $type: String!
) @auth(level: USER) {
  feedback_insert(
    data: {
      cadModelId: $cadModelId
      promptId: $promptId
      userId: $userId
      comments: $comments
      rating: $rating
      type: $type
    }
  )
}

query GetCadModel($id: UUID!) @auth(level: USER) {
  cadModel(id: $id) {
    id
    name
    description
    modelData
    thumbnailUrl
    owner {
      id
      displayName
    }
    project {
      id
      name
    }
  }
}